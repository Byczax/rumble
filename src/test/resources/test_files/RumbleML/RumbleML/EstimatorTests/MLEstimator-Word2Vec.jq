(:JIQS: ShouldRun; Output="({ "label" : 0, "name" : "a", "stringArrayCol" : [ "i", "am", "data", "entry", "1" ], "word2vecResult" : [ -0.00008827828, 0.0015511172, 0.0012456904, -0.00017455248, 0.00076856045, -0.00037089834, -0.000959619, 0.0025182453, -0.00020799141, 0.00035348843, 0.000060372124, -0.001570256, 0.00048183594, -0.00008264915, 0.0019678646, -0.00045818483, -0.0012066972, 0.00012526265, -0.00069719163, -0.00027012263, -0.0027646115, -0.0023180179, 0.0013835154, 0.0006302525, 0.00031363277, -0.00021268702, 0.0025911133, -0.0023531953, -0.0019786593, 0.00094834523, -0.0009493409, -0.0017402583, 0.00079667824, 0.00007586753, -0.0002522038, 0.00027410983, -0.00037878405, 0.0014340893, -0.0012089841, -0.0017257415, 0.00044488328, 0.0005102019, -0.0009055898, 0.000035975176, 0.0005793334, -0.0005341326, -0.0013439569, -0.0000817982, -0.00077790394, -0.00021333783, 0.0012642501, -0.0007411713, 0.00056625804, 0.0016635436, 0.0008368029, -0.0009973658, 0.0007849428, -0.0023398069, -0.0003875856, 0.0010412907, 0.0005507867, 0.0008073827, 0.0024637238, 0.0015164696, 0.00036606396, 0.0012576625, -0.0009936349, -0.002645467, 0.00005925207, 0.0011166747, -0.00046636254, -0.00023170316, 0.0018186483, -0.0014948951, -0.00016428373, -0.00031191722, -0.0013755115, 0.002602994, 0.000023058175, -0.000016855192, -0.0012046595, -0.00014418535, 0.0014693728, 0.0012946867, 0.001601018, 0.00022849043, -0.00071404735, 0.001070978, 0.0004290861, 0.00252478, -0.00049791974, 0.0005268136, -0.0012048893, 0.001335248, -0.00015571, -0.0009739698, -0.0010365712, 0.0007682245, 0.000796427, 0.00041090336 ] }, { "label" : 1, "name" : "b", "stringArrayCol" : [ "i", "am", "data", "entry", "2" ], "word2vecResult" : [ -0.00008827828, 0.0015511172, 0.0012456904, -0.00017455248, 0.00076856045, -0.00037089834, -0.000959619, 0.0025182453, -0.00020799141, 0.00035348843, 0.000060372124, -0.001570256, 0.00048183594, -0.00008264915, 0.0019678646, -0.00045818483, -0.0012066972, 0.00012526265, -0.00069719163, -0.00027012263, -0.0027646115, -0.0023180179, 0.0013835154, 0.0006302525, 0.00031363277, -0.00021268702, 0.0025911133, -0.0023531953, -0.0019786593, 0.00094834523, -0.0009493409, -0.0017402583, 0.00079667824, 0.00007586753, -0.0002522038, 0.00027410983, -0.00037878405, 0.0014340893, -0.0012089841, -0.0017257415, 0.00044488328, 0.0005102019, -0.0009055898, 0.000035975176, 0.0005793334, -0.0005341326, -0.0013439569, -0.0000817982, -0.00077790394, -0.00021333783, 0.0012642501, -0.0007411713, 0.00056625804, 0.0016635436, 0.0008368029, -0.0009973658, 0.0007849428, -0.0023398069, -0.0003875856, 0.0010412907, 0.0005507867, 0.0008073827, 0.0024637238, 0.0015164696, 0.00036606396, 0.0012576625, -0.0009936349, -0.002645467, 0.00005925207, 0.0011166747, -0.00046636254, -0.00023170316, 0.0018186483, -0.0014948951, -0.00016428373, -0.00031191722, -0.0013755115, 0.002602994, 0.000023058175, -0.000016855192, -0.0012046595, -0.00014418535, 0.0014693728, 0.0012946867, 0.001601018, 0.00022849043, -0.00071404735, 0.001070978, 0.0004290861, 0.00252478, -0.00049791974, 0.0005268136, -0.0012048893, 0.001335248, -0.00015571, -0.0009739698, -0.0010365712, 0.0007682245, 0.000796427, 0.00041090336 ] }, { "label" : 2, "name" : "c", "stringArrayCol" : [ "i", "am", "data", "entry", "3" ], "word2vecResult" : [ -0.00008827828, 0.0015511172, 0.0012456904, -0.00017455248, 0.00076856045, -0.00037089834, -0.000959619, 0.0025182453, -0.00020799141, 0.00035348843, 0.000060372124, -0.001570256, 0.00048183594, -0.00008264915, 0.0019678646, -0.00045818483, -0.0012066972, 0.00012526265, -0.00069719163, -0.00027012263, -0.0027646115, -0.0023180179, 0.0013835154, 0.0006302525, 0.00031363277, -0.00021268702, 0.0025911133, -0.0023531953, -0.0019786593, 0.00094834523, -0.0009493409, -0.0017402583, 0.00079667824, 0.00007586753, -0.0002522038, 0.00027410983, -0.00037878405, 0.0014340893, -0.0012089841, -0.0017257415, 0.00044488328, 0.0005102019, -0.0009055898, 0.000035975176, 0.0005793334, -0.0005341326, -0.0013439569, -0.0000817982, -0.00077790394, -0.00021333783, 0.0012642501, -0.0007411713, 0.00056625804, 0.0016635436, 0.0008368029, -0.0009973658, 0.0007849428, -0.0023398069, -0.0003875856, 0.0010412907, 0.0005507867, 0.0008073827, 0.0024637238, 0.0015164696, 0.00036606396, 0.0012576625, -0.0009936349, -0.002645467, 0.00005925207, 0.0011166747, -0.00046636254, -0.00023170316, 0.0018186483, -0.0014948951, -0.00016428373, -0.00031191722, -0.0013755115, 0.002602994, 0.000023058175, -0.000016855192, -0.0012046595, -0.00014418535, 0.0014693728, 0.0012946867, 0.001601018, 0.00022849043, -0.00071404735, 0.001070978, 0.0004290861, 0.00252478, -0.00049791974, 0.0005268136, -0.0012048893, 0.001335248, -0.00015571, -0.0009739698, -0.0010365712, 0.0007682245, 0.000796427, 0.00041090336 ] }, { "label" : 3, "name" : "d", "stringArrayCol" : [ "i", "am", "data", "entry", "4" ], "word2vecResult" : [ -0.00008827828, 0.0015511172, 0.0012456904, -0.00017455248, 0.00076856045, -0.00037089834, -0.000959619, 0.0025182453, -0.00020799141, 0.00035348843, 0.000060372124, -0.001570256, 0.00048183594, -0.00008264915, 0.0019678646, -0.00045818483, -0.0012066972, 0.00012526265, -0.00069719163, -0.00027012263, -0.0027646115, -0.0023180179, 0.0013835154, 0.0006302525, 0.00031363277, -0.00021268702, 0.0025911133, -0.0023531953, -0.0019786593, 0.00094834523, -0.0009493409, -0.0017402583, 0.00079667824, 0.00007586753, -0.0002522038, 0.00027410983, -0.00037878405, 0.0014340893, -0.0012089841, -0.0017257415, 0.00044488328, 0.0005102019, -0.0009055898, 0.000035975176, 0.0005793334, -0.0005341326, -0.0013439569, -0.0000817982, -0.00077790394, -0.00021333783, 0.0012642501, -0.0007411713, 0.00056625804, 0.0016635436, 0.0008368029, -0.0009973658, 0.0007849428, -0.0023398069, -0.0003875856, 0.0010412907, 0.0005507867, 0.0008073827, 0.0024637238, 0.0015164696, 0.00036606396, 0.0012576625, -0.0009936349, -0.002645467, 0.00005925207, 0.0011166747, -0.00046636254, -0.00023170316, 0.0018186483, -0.0014948951, -0.00016428373, -0.00031191722, -0.0013755115, 0.002602994, 0.000023058175, -0.000016855192, -0.0012046595, -0.00014418535, 0.0014693728, 0.0012946867, 0.001601018, 0.00022849043, -0.00071404735, 0.001070978, 0.0004290861, 0.00252478, -0.00049791974, 0.0005268136, -0.0012048893, 0.001335248, -0.00015571, -0.0009739698, -0.0010365712, 0.0007682245, 0.000796427, 0.00041090336 ] }, { "label" : 4, "name" : "e", "stringArrayCol" : [ "i", "am", "data", "entry", "5" ], "word2vecResult" : [ -0.00008827828, 0.0015511172, 0.0012456904, -0.00017455248, 0.00076856045, -0.00037089834, -0.000959619, 0.0025182453, -0.00020799141, 0.00035348843, 0.000060372124, -0.001570256, 0.00048183594, -0.00008264915, 0.0019678646, -0.00045818483, -0.0012066972, 0.00012526265, -0.00069719163, -0.00027012263, -0.0027646115, -0.0023180179, 0.0013835154, 0.0006302525, 0.00031363277, -0.00021268702, 0.0025911133, -0.0023531953, -0.0019786593, 0.00094834523, -0.0009493409, -0.0017402583, 0.00079667824, 0.00007586753, -0.0002522038, 0.00027410983, -0.00037878405, 0.0014340893, -0.0012089841, -0.0017257415, 0.00044488328, 0.0005102019, -0.0009055898, 0.000035975176, 0.0005793334, -0.0005341326, -0.0013439569, -0.0000817982, -0.00077790394, -0.00021333783, 0.0012642501, -0.0007411713, 0.00056625804, 0.0016635436, 0.0008368029, -0.0009973658, 0.0007849428, -0.0023398069, -0.0003875856, 0.0010412907, 0.0005507867, 0.0008073827, 0.0024637238, 0.0015164696, 0.00036606396, 0.0012576625, -0.0009936349, -0.002645467, 0.00005925207, 0.0011166747, -0.00046636254, -0.00023170316, 0.0018186483, -0.0014948951, -0.00016428373, -0.00031191722, -0.0013755115, 0.002602994, 0.000023058175, -0.000016855192, -0.0012046595, -0.00014418535, 0.0014693728, 0.0012946867, 0.001601018, 0.00022849043, -0.00071404735, 0.001070978, 0.0004290861, 0.00252478, -0.00049791974, 0.0005268136, -0.0012048893, 0.001335248, -0.00015571, -0.0009739698, -0.0010365712, 0.0007682245, 0.000796427, 0.00041090336 ] }, { "label" : 5, "name" : "f", "stringArrayCol" : [ "i", "am", "data", "entry", "6" ], "word2vecResult" : [ -0.00008827828, 0.0015511172, 0.0012456904, -0.00017455248, 0.00076856045, -0.00037089834, -0.000959619, 0.0025182453, -0.00020799141, 0.00035348843, 0.000060372124, -0.001570256, 0.00048183594, -0.00008264915, 0.0019678646, -0.00045818483, -0.0012066972, 0.00012526265, -0.00069719163, -0.00027012263, -0.0027646115, -0.0023180179, 0.0013835154, 0.0006302525, 0.00031363277, -0.00021268702, 0.0025911133, -0.0023531953, -0.0019786593, 0.00094834523, -0.0009493409, -0.0017402583, 0.00079667824, 0.00007586753, -0.0002522038, 0.00027410983, -0.00037878405, 0.0014340893, -0.0012089841, -0.0017257415, 0.00044488328, 0.0005102019, -0.0009055898, 0.000035975176, 0.0005793334, -0.0005341326, -0.0013439569, -0.0000817982, -0.00077790394, -0.00021333783, 0.0012642501, -0.0007411713, 0.00056625804, 0.0016635436, 0.0008368029, -0.0009973658, 0.0007849428, -0.0023398069, -0.0003875856, 0.0010412907, 0.0005507867, 0.0008073827, 0.0024637238, 0.0015164696, 0.00036606396, 0.0012576625, -0.0009936349, -0.002645467, 0.00005925207, 0.0011166747, -0.00046636254, -0.00023170316, 0.0018186483, -0.0014948951, -0.00016428373, -0.00031191722, -0.0013755115, 0.002602994, 0.000023058175, -0.000016855192, -0.0012046595, -0.00014418535, 0.0014693728, 0.0012946867, 0.001601018, 0.00022849043, -0.00071404735, 0.001070978, 0.0004290861, 0.00252478, -0.00049791974, 0.0005268136, -0.0012048893, 0.001335248, -0.00015571, -0.0009739698, -0.0010365712, 0.0007682245, 0.000796427, 0.00041090336 ] })" :)


let $data := annotate(
    json-file("../../../../queries/rumbleML/sample-ml-data-flat.json"),
    { "label": "integer", "binaryLabel": "integer", "name": "string", "age": "double", "weight": "double", "booleanCol": "boolean", "nullCol": "null", "stringCol": "string", "stringArrayCol": ["string"], "intArrayCol": ["integer"],  "doubleArrayCol": ["double"],  "doubleArrayArrayCol": [["double"]] }
)

let $est := get-estimator("Word2Vec")
let $tra := $est(
    $data,
    { "inputCol": "stringArrayCol", "outputCol": "word2vecResult"}
)
for $result in $tra(
    $data,
    { }
)
return {
    "label": $result.label,
    "name": $result.name,
    "stringArrayCol": $result.stringArrayCol,
    "word2vecResult": [ for $v in $result.word2vecResult[] return float($v) ]
}
