(:JIQS: ShouldRun; Output="({ "label" : 0, "name" : "a", "age" : 20, "weight" : 50, "topicDistribution" : [ 0.0013421059964800973, 0.0013421178022214842, 0.0013421221010903304, 0.9879209599059716, 0.0013421202779286877, 0.0013421148663441682, 0.0013421202179268866, 0.0013421101206659157, 0.0013421200928362645, 0.0013421086185344793 ] }, { "label" : 1, "name" : "b", "age" : 21, "weight" : 55.3, "topicDistribution" : [ 0.0012326722556894579, 0.001232681634136114, 0.0012326877598982683, 0.9889058579768655, 0.0012326998353731986, 0.0012326802224876304, 0.0012326846636525497, 0.0012326755851642913, 0.0012326855246549942, 0.001232674542077885 ] }, { "label" : 2, "name" : "c", "age" : 22, "weight" : 60.6, "topicDistribution" : [ 0.0011397392657870565, 0.0011397467904180974, 0.001139754937231896, 0.9897422351058752, 0.0011397915401347635, 0.0011397465983924687, 0.0011397502262801482, 0.0011397419851746705, 0.0011397522662160034, 0.0011397412844896993 ] }, { "label" : 3, "name" : "d", "age" : 23, "weight" : 65.9, "topicDistribution" : [ 0.0010598366058719047, 0.0010598426893236644, 0.0010598488339091353, 0.9904614205739993, 0.0010598400566328877, 0.0010598423506260573, 0.0010598463902875114, 0.0010598388493296444, 0.0010598452436209778, 0.001059838406399127 ] }, { "label" : 4, "name" : "e", "age" : 24, "weight" : 70.3, "topicDistribution" : [ 0.0009997603066058502, 0.0009997655689656607, 0.0009997718574768742, 0.9910021108529732, 0.0009997638670097811, 0.0009997656245903544, 0.00099976932339485, 0.0009997622738587546, 0.0009997683597990736, 0.0009997619653255407 ] }, { "label" : 5, "name" : "f", "age" : 25, "weight" : 75.6, "topicDistribution" : [ 0.0009377452000799334, 0.0009377495005297823, 0.0009377560584649887, 0.9915602506421551, 0.0009377489962713173, 0.0009377500531787215, 0.0009377533738877748, 0.0009377468464644075, 0.0009377526259928882, 0.0009377467029749153 ] })" :)
let $data := annotate(
    json-file("./src/main/resources/queries/rumbleML/sample-ml-data-flat.json"),
    { "label": "integer", "binaryLabel": "integer", "name": "string", "age": "double", "weight": "double", "booleanCol": "boolean", "nullCol": "null", "stringCol": "string", "stringArrayCol": ["string"], "intArrayCol": ["integer"],  "doubleArrayCol": ["double"],  "doubleArrayArrayCol": [["double"]] }
)

let $est := get-estimator("LDA")
let $tra := $est(
    $data,
    { "featuresCol": ["age", "weight"] }
)
for $result in $tra(
    $data,
    { "featuresCol": ["age", "weight"] }
)
return {
    "label": $result.label,
    "name": $result.name,
    "age": $result.age,
    "weight": $result.weight,
    "topicDistribution": $result.topicDistribution
}
